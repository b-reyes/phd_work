%%%%%runs from MIO for CSU PAPER


alpha_1_Q = [-1.12830067057757,-1.13298994115451,-1.13085893301004, ...
    -1.13007935596286,-1.13127613872817];

alpha_1_s = [4.794878386449337E-003,2.757561605815880E-003,1.430084599185553E-003, ...
    6.759543504604780E-004,3.075257472667837E-004];

alpha_1_time = [26383.0857179165*6,40427.5190050602*6,40818.5317320824*12, ...
    40925.2401299477*24,53538.0224859715*42]; 


alpha_2_Q = [-1.12955090229163,-1.13147197691912,-1.13112917150299, ...
    -1.13130267399860,-1.13130861121543];

alpha_2_s = [9.264037354583920E-004,2.734101930832903E-004,1.474500610619132E-004, ...
    5.768320355688102E-005,1.464626864099405E-005];

alpha_2_time = [26835.7528569698*6,40733.8441469669*6,40801.6530280113*12, ...
    40767.7824029922*24,53961.3348808289*42]; 


alpha_3_Q = [-1.13146426467532,-1.13103494552653,-1.13138677189325, ...
    -1.13133548746411,-1.13131320922650];

alpha_3_s = [4.007280730982196E-004,2.358121522980661E-004,1.301370285579761E-004, ...
    7.909217069016282E-005,6.594512121909500E-005];

alpha_3_time = [26430.0210459232*6,40412.1849651337*6,40786.7888031006*12, ...
    40937.7129797935*24,53855.3974580765*42]; 

mc_Q = [-1.12651407042552,-1.14514176283904,-1.13594987192940,-1.13363214347675, ...
    -1.13671890340050,-1.13241809640148,-1.13448112597724,-1.13191162371972];

mc_s = [1.823318476432153E-002,8.332031802488588E-003,6.516461211442399E-003, ...
    5.615973324583577E-003,2.877526581800972E-003,2.138532804164896E-003, ...
    1.453594837689989E-003,8.288470387633821E-004];

mc_time = [26870.9950718880*6,40507.3483531475*6,40806.4036772251*12, ...
    40843.7129578590*24,53468.4661171436*42,41062.2085978985*120, ...
    41338.7413029671*216,68971.3411779404*462];
 
mlmc_Q = [-1.15333016257503,-1.13647901947950,-1.12921199766345,-1.07431264768132, ...
    -1.12043776087827,-1.13521936966162,-1.13115499589993];

mlmc_s = [7.065396251561175E-003,5.099860495659516E-003,3.734824178663131E-003, ...
    2.674357880886153E-003,1.906497580340462E-003,1.358300834215362E-003,9.491439471404689E-004];

mlmc_time = [7105.56599807739,7137.29539489746,7391.07529449463, ...
    7980.39925003052,8634.94572830200,9779.90459060669,20018.0358734131];

mlmc_nl = zeros(7,4);
 mlmc_nl(1,1:4) = [971,64,32,1];
 mlmc_nl(2,1:4) = [1963,64,32,2];
 mlmc_nl(3,1:4) = [3877,64,32,4];
 mlmc_nl(4,1:4) = [9093,106,38,6];
 mlmc_nl(5,1:4) = [15659,252,64,8];
 mlmc_nl(6,:) = [32661,395,141,13];
 mlmc_nl(7,:) = [63509,907,317,29];
 
ls_mlmc = zeros(6,4);

ls_mlmc (1,1:4) = 0:3;
ls_mlmc (2,1:4) = 0:3;
ls_mlmc (3,1:4) = 0:3; 
ls_mlmc (4,1:4) = 0:3;
ls_mlmc (5,1:4) = 0:3;
ls_mlmc (6,1:4) = 0:3; 
ls_mlmc (7,1:4) = 0:3;


alpha_1_Q_ml = [-1.13990590053394,-1.13990590053394,-1.13617750072398,-1.13617750072398, ...
    -1.13427940142054,-1.13308568988962,-1.13377476090280,-1.13312733869667, ...
    -1.13330650700680,-1.13318735652124,-1.13280205323412];

alpha_1_s_ml = [4.583683513615230E-003,4.583683513615230E-003,2.366011659037635E-003, ...
    2.366011659037635E-003,1.504827943923822E-003,1.209194405835809E-003, ...
    7.236929956707626E-004,6.371846722903846E-004,4.560093663609607E-004,3.363025290439953E-004, ...
    1.808774877337059E-004];

alpha_1_time_ml = [450.889488220215,451.109375000000,473.776462554932, ...
    473.727008819580,521.728897094727,562.900382995605,644.042320251465,719.681983947754, ...
    893.876941680908,1389.03945541382,2199.50603485107];

mlqmc_alpha_1_nl = zeros(7,3);
mlqmc_alpha_1_nl(1,:) = [15,1,1]*.32;
mlqmc_alpha_1_nl(2,:) = [15,1,1]*.32;
mlqmc_alpha_1_nl(3,:) = [31,1,1]*.32;
mlqmc_alpha_1_nl(4,:) = [31,1,1]*.32;
mlqmc_alpha_1_nl(5,:) = [63,1,1]*.32;
mlqmc_alpha_1_nl(6,:) = [63,3,1]*.32;
mlqmc_alpha_1_nl(7,:) = [127,3,1]*.32;
mlqmc_alpha_1_nl(8,:) = [127,7,1]*.32;
mlqmc_alpha_1_nl(9,:) = [255,7,1]*.32;
mlqmc_alpha_1_nl(10,:) = [511,15,1]*.32;
mlqmc_alpha_1_nl(11,:) = [511,15,3]*.32;


alpha_2_Q_ml = [-1.13722337477594,-1.13536217719397,-1.13536217719397,-1.13536217719397, ...
    -1.13508277491001,-1.13483366845919,-1.13336468960156,-1.13324452099515, ...
    -1.13278817894023,-1.13260948755801,-1.13260948755801];

alpha_2_s_ml = [5.647681702279956E-003,2.631759342787166E-003,2.631759342787166E-003, ...
    2.631759342787166E-003,1.571797846750123E-003,1.192901139838594E-003, ...
    7.677726682691397E-004,5.612691132361541E-004,4.574065915985301E-004, ... 
    2.162744631023118E-004,2.162744631023118E-004];

alpha_2_time_ml = [439.875408172607,451.334815979004,451.978111267090,455.482002258301,...
    474.826210021973,518.979858398438,558.057773590088,645.071296691895, ...
    720.453918457031,1847.45227432251,1844.46697616577];

mlqmc_alpha_2_nl = zeros(7,3);
mlqmc_alpha_2_nl(1,:) = [7,1,1]*.32;
mlqmc_alpha_2_nl(2,:) = [15,1,1]*.32;
mlqmc_alpha_2_nl(3,:) = [15,1,1]*.32;
mlqmc_alpha_2_nl(4,:) = [15,1,1]*.32;
mlqmc_alpha_2_nl(5,:) = [31,1,1]*.32;
mlqmc_alpha_2_nl(6,:) = [63,1,1]*.32;
mlqmc_alpha_2_nl(7,:) = [63,3,1]*.32;
mlqmc_alpha_2_nl(8,:) = [127,3,1]*.32;
mlqmc_alpha_2_nl(9,:) = [127,7,1]*.32;
mlqmc_alpha_2_nl(10,:) = [255,15,3]*.32;
mlqmc_alpha_2_nl(11,:) = [255,15,3]*.32;


ls_mlqmc = zeros(11,3);
 
ls_mlqmc(1,:) = 0:2;
ls_mlqmc(2,:) = 0:2;
ls_mlqmc(3,:) = 0:2; 
ls_mlqmc(4,:) = 0:2;
ls_mlqmc(5,:) = 0:2;
ls_mlqmc(6,:) = 0:2;
ls_mlqmc(7,:) = 0:2;
ls_mlqmc(8,:) = 0:2;
ls_mlqmc(9,:) = 0:2;
ls_mlqmc(10,:) = 0:2;
ls_mlqmc(11,:) = 0:2;

figure(1)
subplot(1,2,1)
loglog(2.^[8,9,10,11,12,13,14,16],mc_s,'k*-',2.^(8:12),alpha_1_s,'r*-',2.^(8:12),alpha_2_s,'b*-', ...
    2.^(8:12),1./2.^(8:12),'go-',2.^(8:12),1./(2.^(8:12)).^(1.25),'g*-')
title('MC vs QMC for 3D Model')
ylabel('S_E[Q]')
xlabel('Number of Samples')
legend('MC','QMC \alpha = 1','QMC \alpha = 2','N^{-1}','N^{-1.25}')

subplot(1,2,2)
loglog(mc_s,mc_time./60,'k*-',alpha_1_s,alpha_1_time./60,'r*-',alpha_2_s,alpha_2_time./60,'b*-')
title('S_E[Q] vs Runtime')
ylabel('Runtime (Minutes)')
xlabel('S_E[Q]')
legend('MC','QMC \alpha = 1','QMC \alpha = 2')


figure(2)
subplot(1,2,1)
loglog(alpha_1_s_ml,alpha_1_time_ml./60,'b*-',alpha_1_s,alpha_1_time./60,'bo-') 
title('S_E[Q] vs. Runtime')
ylabel('Runtime (Minutes)')
xlabel('S_E[Q]')
legend('MLQMC \alpha = 1','QMC \alpha = 1')

subplot(1,2,2)
loglog(alpha_2_s_ml,alpha_2_time_ml./60,'r*-',alpha_2_s,alpha_2_time./60,'ro-')
title('S_E[Q] vs. Runtime')
ylabel('Runtime (Minutes)')
xlabel('S_E[Q]')
legend('MLQMC \alpha = 2','QMC \alpha = 2')

figure(3)
subplot(1,2,1)
semilogy(ls_mlqmc',32*mlqmc_alpha_1_nl','*-')
xlabel('Level')
ylabel('Number of Samples per Level')
legend('S_E[Q] = 4.5836e-03','S_E[Q] = 4.5836e-03','S_E[Q] = 2.3660e-03','S_E[Q] = 2.3660e-03', ... 
    'S_E[Q] = 1.5048e-03','S_E[Q] = 1.2091e-03','S_E[Q] = 7.2369e-04','S_E[Q] = 6.3718e-04','S_E[Q] = 4.5600e-04', ...
    'S_E[Q] = 3.3630e-04','S_E[Q] = 1.8087e-04')
title('MLQMC \alpha = 1')

subplot(1,2,2)
semilogy(ls_mlqmc',32*mlqmc_alpha_2_nl','*-')
xlabel('Level')
ylabel('Number of Samples per Level')
legend('S_E[Q] = 5.6476e-03','S_E[Q] = 2.6317e-03','S_E[Q] = 2.6317e-03','S_E[Q] = 2.6317e-03', ... 
    'S_E[Q] = 1.5717e-03','S_E[Q] = 1.1929e-03','S_E[Q] = 7.6777e-04','S_E[Q] = 5.6126e-04','S_E[Q] = 4.5740e-04', ...
    'S_E[Q] = 2.1627e-04','S_E[Q] = 2.1627e-04')
title('MLQMC \alpha = 2')




