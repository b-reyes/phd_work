%%%%%runs from MIO for CSU PAPER
close all 
clear all

mmin = 10;
mmax = 16;

mmin2 = 10;
mmax2 = 16;


mc_Q = [-1.10138026228083,-1.08612613191539,-1.10278820115745,-1.08586452540283, ...
    -1.08180913715267,-1.09118038448140,-1.09105362833732,-1.09212810859695, ...
    -1.08926164555325];

mc_s = [2.152910287912581E-002,1.160718042129114E-002,5.923845648254799E-003,4.495095680290009E-003, ...
    2.825000501105110E-003,2.393880533053263E-003,2.126703412024480E-003,1.205242004700154E-003, ...
    1.076317941767649E-003];

mc_time = [5841.99635815620*16,11654.8776941299*16,23321.1865110397*16,46357.8646769524*16, ...
    31839.4927430153*48,37730.0792481899*80,54793.6430308819*112,57886.5867080688*208, ...
    72416.1799030304*336]; 
 
mlmc_Q = [-1.08954052889765,-1.10671763115701,-1.09574065778474, ...
    -1.08404275783359,-1.09043010373991,-1.08917472076640,-1.08988866745241, ...
    -1.08956718646385,-1.08930201924614,-1.08966612921783,-1.08964709811642];

mlmc_s = [1.095053577218280E-002,6.575947293236597E-003, ...
    4.767419418398791E-003,3.169577013717589E-003,2.089569459557227E-003,1.376694711771757E-003, ...
    9.067335027328407E-004,5.985627331907119E-004,3.938982184611671E-004, ...
    2.534311900071415E-004,1.714676281393767E-004];

mlmc_time = [92.5008990764618*16,100.012082099915*16,109.065316200256*16,137.415297031403*16,195.640527009964*16, ...
    341.368877887726*16,689.451452970505*16,2054.48872494698*16,3844.95436406136*16, ...
    8684.23573398590*16,18040.2043991089*16];
 
mlmc_nl = zeros(7,5);
 mlmc_nl(1,1:4) = [342,2,2,1];
 mlmc_nl(2,1:4) = [1053,8,4,1];
 mlmc_nl(3,1:4) = [1883,8,4,1];
 mlmc_nl(4,1:4) = [4354,8,4,1];
 mlmc_nl(5,1:4) = [9624,8,4,1];
 mlmc_nl(6,1:4) = [22481,17,4,1];
 mlmc_nl(7,1:4) = [52966,44,9,2]; 
 mlmc_nl(8,1:5) = [120569,133,19,2,1]; 
 mlmc_nl(9,1:5) = [278510,359,64,6,1]; 
 mlmc_nl(10,:) = [691169,741,186,20,4]; 
 mlmc_nl(11,:) = [1505930,1462,366,47,9];
 
ls_mlmc = zeros(7,5);
ls_mlmc(1,1:4) = 0:3;
ls_mlmc(2,1:4) = 0:3;
ls_mlmc(3,1:4) = 0:3; 
ls_mlmc(4,1:4) = 0:3;
ls_mlmc(5,1:4) = 0:3;
ls_mlmc(6,1:4) = 0:3;
ls_mlmc(7,1:4) = 0:3;
ls_mlmc(8,1:5) = 0:4;
ls_mlmc(9,1:5) = 0:4;
ls_mlmc(10,1:5) = 0:4;
ls_mlmc(11,1:5) = 0:4; 


alpha_1_Q_ml = [-1.09012351372475,-1.09022896348107,-1.09015121205799,-1.09016726996603, ...
    -1.09026088764692,-1.09025396413798,-1.09024928773040];

alpha_1_s_ml = [4.451435561085718E-004,1.956218714716241E-004,1.118428549421299E-004, ...
    6.058752127111034E-005,3.218989935903585E-005,1.573193681840071E-005, ...
    6.879215717197540E-006];

alpha_1_time_ml = [77.3093881607056*16,122.172584056854*16,219.972718954086*16, ...
    466.538388013840*16,848.921245098114*16,1705.95519304276*16, ...
    3420.24555397034*16];

ls_mlqmc = zeros(7,3);

ls_mlqmc(1,:) = 0:2;
ls_mlqmc(2,:) = 0:2;
ls_mlqmc(3,:) = 0:2; 
ls_mlqmc(4,:) = 0:2;
ls_mlqmc(5,:) = 0:2;
ls_mlqmc(6,:) = 0:2;
ls_mlqmc(7,:) = 0:2;

mlqmc_alpha_1_nl = zeros(7,3);
mlqmc_alpha_1_nl(1,:) = [127,1,1];
mlqmc_alpha_1_nl(2,:) = [255,1,1];
mlqmc_alpha_1_nl(3,:) = [511,3,1];
mlqmc_alpha_1_nl(4,:) = [1023,7,3];
mlqmc_alpha_1_nl(5,:) = [2047,15,3];
mlqmc_alpha_1_nl(6,:) = [4095,31,7];
mlqmc_alpha_1_nl(7,:) = [8191,63,15];

alpha_2_Q_ml = [-1.09065430215452,-1.09043326573195,-1.09030872808817, ...
    -1.09025902565278,-1.09023649584024,-1.09023515347333,-1.09023703485051];

alpha_2_s_ml = [6.483165738357735E-004,3.197819791408797E-004,1.611895966068158E-004, ...
    8.065426539872936E-005,4.264556863843124E-005,2.132351138482789E-005, ...
    6.802717983456495E-006];

alpha_2_time_ml = [53.9393289089203*16,77.1818079948425*16,130.215121030807*16, ...
    283.936765909195*16,489.201088905334*16,999.368301868439*16, ...
    3416.64130401611*16];

mlqmc_alpha_2_nl = zeros(7,3);
mlqmc_alpha_2_nl(1,:) = [63,1,1];
mlqmc_alpha_2_nl(2,:) = [127,1,1];
mlqmc_alpha_2_nl(3,:) = [255,3,1];
mlqmc_alpha_2_nl(4,:) = [511,7,3];
mlqmc_alpha_2_nl(5,:) = [1023,15,3];
mlqmc_alpha_2_nl(6,:) = [2047,31,7];
mlqmc_alpha_2_nl(7,:) = [8191,63,15];




alpha_1_Q = [-1.08882223247256,-1.08986210193871,-1.08956266630951,-1.08974383036516, ...
    -1.08978611150492,-1.08983287206453,-1.08992613520050,-1.08991775385975, ...
    -1.08991480454943,];

alpha_1_s = [1.096581841250886E-003,6.371329491929357E-004,3.022987515459027E-004, ... 
    1.329329941599821E-004,7.314025785249688E-005,3.085031632062977E-005, ...
    1.636658005009660E-005,8.064578379273041E-006,3.457571509973635E-006, ...
    ];

alpha_1_time = [5851.92510008812*16,11657.7063338757*16,23246.8050129414*16, ... 
    46267.6363430023*16,31825.1102418900*48,37661.5721831322*80, ...
    54945.8573210239*112,58127.7678270340*208,72863.4344148636*336]; 
 

alpha_2_Q = [-1.08989862450270,-1.08996873695450,-1.08990447320548,-1.08992638901591, ...
    -1.08990770758370,-1.08990743181596,-1.08990770879247,-1.08990801516452, ...
    -1.08990791756145];

alpha_2_s = [1.616596761423791E-004,1.094655008429083E-004,3.011625129798097E-005, ...
    1.402424039542054E-005,5.970269255736116E-006,3.775612981600849E-006, ...
    3.146991539718116E-006,1.886538402034880E-006,1.103447104335362E-006];

alpha_2_time = [5854.50957107544*16,11694.9785060883*16,23297.6819789410*16, ...
    46432.8300018311*16,31871.5572569370*48,37668.0619070530*80, ...
    54989.8645539284*112,58001.7382140160*208,72406.0884909630*336]; 

figure(1)
subplot(1,2,1)
loglog(2.^(10:18),mc_s,'k*-',2.^(10:18),alpha_1_s,'r*-',2.^(10:18),alpha_2_s,'b*-', ...
    2.^(10:18),1./2.^(10:18),'go-',2.^(10:18),1./(2.^(10:18)).^(1.25),'g*-')
title('MC vs QMC for 2D Model')
ylabel('S_E[Q]')
xlabel('Number of Samples')
legend('MC','QMC \alpha = 1','QMC \alpha = 2','N^{-1}','N^{-1.25}')

subplot(1,2,2)
loglog(mc_s,mc_time./60,'k*-',alpha_1_s,alpha_1_time./60,'r*-',alpha_2_s,alpha_2_time./60,'b*-')
title('S_E[Q] vs Runtime')
ylabel('Runtime (Minutes)')
xlabel('S_E[Q]')
legend('MC','QMC \alpha = 1','QMC \alpha = 2') 

figure(2)
subplot(1,2,1)
loglog(alpha_1_s_ml,alpha_1_time_ml./60,'b*-',alpha_1_s,alpha_1_time./60,'bo-') 
title('S_E[Q] vs. Runtime')
ylabel('Runtime (Minutes)')
xlabel('S_E[Q]')
legend('MLQMC \alpha = 1','QMC \alpha = 1')

subplot(1,2,2)
loglog(alpha_2_s_ml,alpha_2_time_ml./60,'r*-',alpha_2_s,alpha_2_time./60,'ro-')
title('S_E[Q] vs. Runtime')
ylabel('Runtime (Minutes)')
xlabel('S_E[Q]')
legend('MLQMC \alpha = 2','QMC \alpha = 2')

figure(3)
subplot(1,2,1)
semilogy(ls_mlqmc',32*mlqmc_alpha_1_nl','*-')
xlabel('Level')
ylabel('Number of Samples per Level')
legend('S_E[Q_S] = 4.4514e-04','S_E[Q_S] = 1.9562e-04','S_E[Q_S] = 1.1184e-04','S_E[Q_S] = 6.0587e-05', ... 
    'S_E[Q_S] = 3.2189e-05','S_E[Q_S] = 1.5731e-05','S_E[Q_S] = 6.8792e-06')
title('MLQMC \alpha = 1')

subplot(1,2,2)
semilogy(ls_mlqmc',32*mlqmc_alpha_2_nl','*-')
xlabel('Level')
ylabel('Number of Samples per Level')
legend('S_E[Q_S] = 6.4831e-04','S_E[Q_S] = 3.1978e-04','S_E[Q_S] = 1.6118e-04','S_E[Q_S] = 8.0654e-05', ... 
    'S_E[Q_S] = 4.2645e-05','S_E[Q_S] = 2.1323e-05','S_E[Q_S] = 6.8027e-06')
title('MLQMC \alpha = 2')







