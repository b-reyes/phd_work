close all 
clear all

mmin = 10;
mmax = 16;

mmin2 = 10;
mmax2 = 16;

mc_Q = [4.55703633885726,4.66181885579028,4.68364227468340,4.59264846042700, ...
    4.61973210175365,4.63454196631607,4.63147228786658];

mc_var = [4.510702858838578E-002,3.942515150509961E-002,1.675822247175758E-002, ...
    1.138372963597369E-002,9.950629919943096E-003,7.301763364255191E-003, ...
    6.048063203144405E-003];

mc_time = [8186.77232599258*16,16444.0970520973*16,17708.5297269821*32, ...
    22593.3344218731*48,22737.0287830830*96,26820.1075270176*160, ...
    30877.4491539001*288];

%1d moving mirror ran for j^2
qmc_alpha_1_Q_16s = [4.62790653102864,4.62919559879221,4.62594399076493,4.62730788685690, ...
    4.62715836459810,4.62729805714341,4.62722410284581];

qmc_alpha_1_var_16s = [6.629563681090966E-003,2.951958989862463E-003,1.331242615320480E-003, ...
    8.165090676209387E-004,2.517893367369225E-004,1.802616750268834E-004, ...
    5.862676827375119E-005];

qmc_alpha_1_time_16s = [9699.62347483635*16,19444.8922250271*16,16666.5509710312*32, ...
    23133.6495049000*48,23292.2626061440*96,27050.8632979393*160, ...
    31171.6394898891*288];

qmc_alpha_2_Q_16s = [4.62726150403370,4.62723502521374,4.62751878426859,4.62727108102450,4.62727181451537, ...
    4.62727088303365,4.62727118622742];

qmc_alpha_2_var_16s = [1.515651329763582E-004,1.192282857905637E-004,1.099187843837929E-004,1.434379052045522E-006, ...
    3.815956886005577E-007,1.309067499288274E-007,1.033440572445358E-007];

qmc_alpha_3_Q_16s = [4.62747534326386,4.62725875968312,4.62729148244054,4.62726979586611, ...
    4.62727096619631,4.62727096563072,4.62727096712976];

qmc_alpha_3_var_16s = [8.376245462266211E-004,4.415363748787849E-005,1.285580855901599E-005,7.596026763301917E-007, ...
    9.356299550887132E-010,7.990659559133808E-010,1.407303413488363E-011];

qmc_alpha_4_Q_16s = [4.62726520858883,4.62727529110964,4.62727049519282,4.62727097079409,4.62727096743928, ...
    4.62727096558195,4.62727096857077];

qmc_alpha_4_var_16s = [5.820141996884602E-005,6.174771773794916E-006,4.808003374262204E-007,7.909917395377521E-009, ...
    3.064624068449358E-009,2.991087121330002E-009,2.997680763596051E-009];


qmc_alpha_1_Q_32s = [4.62172348231638,4.62669906966408,4.62809166551639,4.62556279654985,4.62748354372343, ...
    4.62740058773793,4.62735695920907];

qmc_alpha_1_var_32s = [7.746301046713158E-003,4.497678668418554E-003,1.999533036714349E-003,1.083393984247547E-003, ...
    4.220770761180370E-004,2.146667565883303E-004,1.099627077788979E-004];

qmc_alpha_1_time_32s = [8240.94402790070*16,16495.6275739670*16,17435.0065200329*32,24566.1742639542*48, ...
    24701.5542309284*96,29038.8328588009*160,33173.8684911728*288];

qmc_alpha_2_Q_32s = [4.62851340069260,4.62696917022240,4.62724019141111,4.62736169197667,4.62727117078968, ...
    4.62727083298689,4.62727093545711,];

qmc_alpha_2_var_32s = [1.536674499066591E-003,8.893251232591052E-005,1.100981359783311E-004,8.622364533764094E-005, ...
    8.394269603227004E-007,2.177420014945632E-007,8.892227873753931E-008,];

qmc_alpha_3_Q_32s = [4.62843270494990,4.62649409536755,4.62726345892208,4.62729451587458,4.62727057773566, ...
    4.62727096714550,4.62727096688014];

qmc_alpha_3_var_32s = [9.960548114752506E-004,5.080798824877691E-004,2.165583787230391E-005,1.094362483923044E-005, ...
    5.562122296435813E-007,6.853510833531167E-010,7.031915705337424E-010];

qmc_alpha_4_Q_32s = [4.62772675502540,4.62731521016211,4.62727087966999,4.62727091461170,4.62727096656280, ...
    4.62727096680501,4.62727096697955];

qmc_alpha_4_var_32s = [1.399453841851295E-003,3.866465664497996E-005,4.009054264649377E-006,3.561439385430856E-007, ...
    7.264182396961845E-009,2.138497238278994E-009,2.081189998543586E-009];


qmc_alpha_1_Q_64s = [4.61559977768971,4.62199375678854,4.62548615890065,4.62850222549893,4.62753988290896, ...
    4.62742602150715,4.62724649310348];

qmc_alpha_1_var_64s = [9.851491209199092E-003,4.666452269120040E-003,2.174019544082227E-003,1.405301233997571E-003, ...
    6.696777493962326E-004,3.133358625411313E-004,1.821710327243373E-004];

qmc_alpha_1_time_64s = [8402.20701122284*16,16479.7009179592*16,16659.3861601353*32,24944.4459738731*48, ...
    24965.3511111736*96,33344.1413030624*160,33290.7550439835*288];

qmc_alpha_2_Q_64s = [4.62903290980324,4.62597709994844,4.62727282159184,4.62728709750040,4.62724179719046, ...
    4.62727135174424,4.62727072052161];

qmc_alpha_2_var_64s = [1.446581379576099E-003,9.877381784155074E-004,8.583762081563066E-005,6.729871910366316E-005, ...
    6.159385652235749E-005,7.100818063228133E-007,1.842082885983758E-007];

qmc_alpha_3_Q_64s = [4.61798475556280,4.62714898442060,4.62786378395541,4.62727297771595,4.62727649630131, ...
    4.62727097181506,4.62727096764297];

qmc_alpha_3_var_64s = [3.774599779976690E-003,7.092567310815665E-004,3.275020477140090E-004,1.879426252646430E-005, ...
    8.176166784162071E-006,3.941528461301399E-007,4.371863303128584E-010];

qmc_alpha_4_Q_64s = [4.63218417219516,4.62751469215238,4.62727318492542,4.62727300552534,4.62727114990094, ...
    4.62727097363793,4.62727096380612];

qmc_alpha_4_var_64s = [8.190451775836013E-003,9.888864460775837E-004,2.807031323638919E-005,3.195313462750667E-006, ...
    2.466964077616509E-007,4.769753015663082E-009,1.489514964203562E-009];   

mlqmc_alpha_1_Q = [4.62473634221069,4.62548379889293,4.62640037127921,4.62606593304899, ...
    4.62612395816917,4.62607303868983,4.62605649115164];

mlqmc_alpha_1_var = [9.617730942723241E-004,5.471124213302423E-004,2.545914427150629E-004, ...
    1.546237512307434E-004,7.251597875789935E-005,4.485022986291191E-005,2.376819233420228E-005];

mlqmc_alpha_1_time = [90.3212988376617*16,175.426851034164*16,358.815950870514*16, ...
    399.905475854874*32,604.565370082855*32,1061.26018691063*32,2120.24271321297*32];


mlmc_Q = [4.66330401479152,4.63621842296175,4.61383989081282,4.62499656874091, ...
    4.62744562790323,4.63261739975302,4.62601407841985];

mlmc_var = [2.157795156889062E-002,1.557668493905716E-002,1.102731710953214E-002, ...
    7.795247203059603E-003,5.519657408799094E-003,3.902702454699037E-003, ...
    2.694431227360774E-003];

mlmc_time = [40.4921600818634*16,64.2247128486633*16,117.526952028275*16, ...
    221.943284988403*16,437.181599140167*16,861.040153026581*16, ... 
    1791.67760014534*16];

mlmc_nl = zeros(7,4);

mlmc_nl(1,1:4) = [4288,10,5,1]; 
mlmc_nl(2,1:4) = [7719,10,5,1];
mlmc_nl(3,1:4) = [15583,10,5,1];
mlmc_nl(4,1:4) = [31125,10,5,2];
mlmc_nl(5,1:4) = [62568,20,6,1];
mlmc_nl(6,1:4) = [125287,42,14,2];
mlmc_nl(7,1:4) = [262721,72,18,3];

ls_mlmc = zeros(7,4);

ls_mlmc(1,1:4) = 1:4;
ls_mlmc(2,1:4) = 1:4;
ls_mlmc(3,1:4) = 1:4; 
ls_mlmc(4,1:4) = 1:4;
ls_mlmc(5,1:4) = 1:4;
ls_mlmc(6,1:4) = 1:4;
ls_mlmc(7,1:4) = 1:4; 

mlqmc_nl = zeros(7,5);

mlqmc_nl(1,1:4) = [383,1,1,1]; 
mlqmc_nl(2,1:4) = [767,1,1,1];
mlqmc_nl(3,1:4) = [1532,4,4,1];
mlqmc_nl(4,1:4) = [2816,32,32,1];
mlqmc_nl(5,1:5) = [3584,128,64,1,1];
mlqmc_nl(6,1:5) = [7680,128,64,1,1];
mlqmc_nl(7,1:5) = [15360,256,128,1,1];

ls = zeros(7,5);

ls(1,1:4) = 1:4;
ls(2,1:4) = 1:4;
ls(3,1:4) = 1:4; 
ls(4,1:4) = 1:4;
ls(5,1:5) = 1:5;
ls(6,1:5) = 1:5;
ls(7,1:5) = 1:5;

figure(1)
loglog(2.^(mmin:mmax),qmc_alpha_1_var_32s,'r*-',...
    2.^(mmin:mmax),qmc_alpha_2_var_32s,'b*-',...
    2.^(mmin:mmax),qmc_alpha_3_var_32s,'c*-',...
    2.^(mmin:mmax),qmc_alpha_4_var_32s,'k*-',...
    2.^(mmin:mmax),mc_var,'m*-',2.^(mmin:mmax),1./(2.^(mmin:mmax)).^1,'g*-', ...
    2.^(mmin:mmax),1./(2.^(mmin:mmax)).^2,'go-')

legend('QMC \alpha = 1 32 Shifts', ...
    'QMC \alpha = 2 32 Shifts', ...
    'QMC \alpha = 3 32 Shifts', ...
    'QMC \alpha = 4 32 Shifts', ...
    'MC','N^{-1}','N^{-2}') 
xlabel('Number of samples')
ylabel('S_E[Q]')
title('MC vs QMC')

figure(2)
loglog(mc_var,mc_time,'ko--',mlmc_var,mlmc_time,'k*-')
legend('Standard MC','MLMC')
xlabel('S_E[Q]')
ylabel('Total CPU Time (seconds)')

figure(3)
semilogy(ls_mlmc',mlmc_nl','*-')
xlabel('Level')
ylabel('Number of Samples per Level')
legend('S_E[Q] = 0.01','S_E[Q] = 0.00447','S_E[Q] = 0.00316','S_E[Q] = 0.00141')
title('MLMC')




